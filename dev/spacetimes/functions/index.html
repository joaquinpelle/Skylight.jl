<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Functions · Skylight</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Skylight logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Skylight</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../gettingstarted/">Getting started</a></li><li><span class="tocitem">Spacetimes</span><ul><li><a class="tocitem" href="../catalogue/">Catalogue</a></li><li class="is-active"><a class="tocitem" href>Functions</a></li><li><a class="tocitem" href="../autodiff/">Automatic differentiation</a></li><li><a class="tocitem" href="../othertypes/">Other types</a></li></ul></li><li><span class="tocitem">Radiative models</span><ul><li><a class="tocitem" href="../../radiativemodels/catalogue/">Catalogue</a></li><li><a class="tocitem" href="../../radiativemodels/functions/">Functions</a></li><li><a class="tocitem" href="../../radiativemodels/radiativeprocesses/">Radiative processes</a></li></ul></li><li><a class="tocitem" href="../../configurations/configurations/">Configurations</a></li><li><span class="tocitem">Initial data</span><ul><li><a class="tocitem" href="../../initialization/pinholecamera/">Pinhole camera</a></li><li><a class="tocitem" href="../../initialization/initialization/">Initialization</a></li></ul></li><li><a class="tocitem" href="../../radiativetransfer/radiativetransfer/">Radiative transfer</a></li><li><span class="tocitem">Postprocess</span><ul><li><a class="tocitem" href="../../postprocess/images/">Images</a></li><li><a class="tocitem" href="../../postprocess/spectra/">Spectra</a></li><li><a class="tocitem" href="../../postprocess/lineemission/">Line emission</a></li><li><a class="tocitem" href="../../postprocess/lightcurves/">Light curves</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/disk_kerr/">Thin disk around a Kerr black hole</a></li><li><a class="tocitem" href="../../examples/corona_kerr/">Lamppost corona above a Kerr black hole</a></li><li><a class="tocitem" href="../../examples/torus_kerr/">Ion torus around a Kerr black hole</a></li><li><a class="tocitem" href="../../examples/frkerr/">f(R)-Kerr black hole</a></li><li><a class="tocitem" href="../../examples/johannsen/">Johannsen black hole</a></li><li><a class="tocitem" href="../../examples/bosonstar/">Boson star</a></li><li><a class="tocitem" href="../../examples/chargedwormhole/">Star across charged wormhole</a></li><li><a class="tocitem" href="../../examples/rar/">RAR galactic core</a></li><li><a class="tocitem" href="../../examples/skylightlogo/">Skylight&#39;s logo</a></li></ul></li><li><span class="tocitem">Utils</span><ul><li><a class="tocitem" href="../../utils/geometry/">Geometry and linear algebra</a></li><li><a class="tocitem" href="../../utils/vectorfields/">Vector fields</a></li><li><a class="tocitem" href="../../utils/constants/">Constants</a></li><li><a class="tocitem" href="../../utils/units/">Units and dimensions</a></li></ul></li><li><span class="tocitem">Developers</span><ul><li><a class="tocitem" href="../../developers/spacetimes/">Adding a spacetime</a></li><li><a class="tocitem" href="../../developers/radiativemodels/">Adding a radiative model</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li><li><a class="tocitem" href="../../publications/">Publications</a></li><li><a class="tocitem" href="../../citing/">Citing</a></li><li><a class="tocitem" href="../../contributing/">Contributing</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Spacetimes</a></li><li class="is-active"><a href>Functions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Functions</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/joaquinpelle/Skylight.jl/blob/main/docs/src/spacetimes/functions.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><article class="docstring"><header><a class="docstring-binding" id="Skylight.allocate_cache-Tuple{AbstractSpacetime}" href="#Skylight.allocate_cache-Tuple{AbstractSpacetime}"><code>Skylight.allocate_cache</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">allocate_cache(spacetime)</code></pre><p>Allocate a cache object for the given spacetime. The cache object is used to store temporary data in spacetime-related calculations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/spacetimes/spacetimes.jl#L17-L21">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.allocate_christoffel_cache-Tuple{AbstractSpacetime}" href="#Skylight.allocate_christoffel_cache-Tuple{AbstractSpacetime}"><code>Skylight.allocate_christoffel_cache</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">allocate_christoffel_cache(spacetime)</code></pre><p>Allocate a cache object for the Christoffel symbols calculation. Unless a more specific method is defined, an instance of <a href="../autodiff/#Skylight.AutoDiffChristoffelCache"><code>Skylight.AutoDiffChristoffelCache</code></a> is returned.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/spacetimes/spacetimes.jl#L80-L85">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.approximate_gradient_norm-Tuple{Array, Real, Real}" href="#Skylight.approximate_gradient_norm-Tuple{Array, Real, Real}"><code>Skylight.approximate_gradient_norm</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">approximate_gradient_norm(z::Array, dx_spacing::Real, dy_spacing::Real)</code></pre><p>Compute the norm of the gradient of a function given a 2D grid of function values <code>z</code> and grid spacings <code>dx_spacing</code> and <code>dy_spacing</code>.</p><p>The gradient is computed using central differences in the interior and forward or backward differences at the edges.</p><p><strong>Arguments</strong></p><ul><li><code>z::Array</code>: 2D grid of function values.</li><li><code>dx_spacing::Real</code>: Grid spacing in the x direction.</li><li><code>dy_spacing::Real</code>: Grid spacing in the y direction.</li></ul><p><strong>Returns</strong></p><ul><li><code>grad_norm::Array</code>: 2D grid of gradient magnitudes.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/grids.jl#L1-L16">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.average_inside_bins-NTuple{5, Any}" href="#Skylight.average_inside_bins-NTuple{5, Any}"><code>Skylight.average_inside_bins</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">average_inside_bins(q, x, y, xbins, ybins)</code></pre><p>Calculate the averages of a quantity <code>q</code> at values <code>(x,y)</code> in each bin defined by <code>xbins</code> and <code>ybins</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/bins.jl#L81-L85">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.average_inside_bins-Tuple{Any, Any, Any}" href="#Skylight.average_inside_bins-Tuple{Any, Any, Any}"><code>Skylight.average_inside_bins</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">average_inside_bins(q, x, bins)</code></pre><p>Calculate the averages of a quantity <code>q</code> at value <code>x</code> in each bin defined by <code>bins</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/bins.jl#L47-L51">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.axial_symmetry-Tuple{AbstractSpacetime}" href="#Skylight.axial_symmetry-Tuple{AbstractSpacetime}"><code>Skylight.axial_symmetry</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">axial_symmetry(spacetime)</code></pre><p>Return <code>IsAxiallySymmetric()</code> if the spacetime is axially symmetric, <code>IsNotAxiallySymmetric()</code> otherwise.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/spacetimes/spacetimes.jl#L117-L121">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.bin_values_and_sum_weights-Tuple{Any, Any, Any}" href="#Skylight.bin_values_and_sum_weights-Tuple{Any, Any, Any}"><code>Skylight.bin_values_and_sum_weights</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">bin_values_and_sum_weights(bins, values, weights)</code></pre><p>Bin <code>values</code> and sum <code>weights</code> in each bin.</p><p><strong>Arguments</strong></p><ul><li><code>bins</code>: Array of bin edges.</li><li><code>values</code>: Array of values to be binned.</li><li><code>weights</code>: Array of weights to be summed in each bin.</li></ul><p><strong>Returns</strong></p><ul><li><code>binned_values</code>: Array of the sum of weights in each bin.</li></ul><p><strong>Notes</strong></p><ul><li>The length of <code>values</code> and <code>weights</code> must be the same.</li><li>Values outside the range of <code>bins</code> are ignored.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/bins.jl#L1-L17">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.christoffel!-Tuple{Any, Any, AbstractSpacetime, Nothing}" href="#Skylight.christoffel!-Tuple{Any, Any, AbstractSpacetime, Nothing}"><code>Skylight.christoffel!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">christoffel!(Γ, position, spacetime, cache)</code></pre><p>Evaluate the Christoffel symbols at the given position and store the result in the given array using cache for temporary storage. Unless a more specific method is defined, automatic differentiation is used to compute the Christoffel symbols.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/spacetimes/spacetimes.jl#L70-L75">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.christoffel!-Tuple{Any, Any, AbstractSpacetime, Skylight.AutoDiffChristoffelCache}" href="#Skylight.christoffel!-Tuple{Any, Any, AbstractSpacetime, Skylight.AutoDiffChristoffelCache}"><code>Skylight.christoffel!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>&quot; Calculates the Christoffel symbols of a given spacetime metric using the forward-mode automatic differentiation package ForwardDiff.</p><p>Arguments:</p><ul><li>Γ₂: mutable array of size (4,4,4) to store the resulting Christoffel symbols.</li><li>position: tuple of four numbers representing a position in spacetime.</li><li>spacetime: object representing the spacetime.</li><li>cache: object of type AutoDiffChristoffelCache with containers for metric elements and derivatives.</li></ul><p>Returns: nothing.</p><p>Note: for the automatic differentiation to work on a given spacetime, any spacetime cache array used in  metric calculations must be wrapped by the DiffCache() method as:</p><pre><code class="nohighlight hljs">```
@with_kw mutable struct KerrSpacetimeCache{T} &lt;: AbstractSpacetimeCache
    l::T = DiffCache(zeros(4))
end
```</code></pre><p>This is because automatic differentiation keeps two versions of each variable, a Real and a Dual version, the latter being used to compute derivatives at each node of the chain rule. Also, in the <code>metric!(g, position, spacetime)</code> function, the caches must be accessed via the function <code>get_tmp</code> as in <code>get_tmp(spacetime.l, position)</code>, so that the appropriate version of the cache is returned according to the element type of position when <code>metric!</code> is called.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/spacetimes/autodiff.jl#L1-L27">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.circular_geodesic_angular_speed-Tuple{Any, Any, Any}" href="#Skylight.circular_geodesic_angular_speed-Tuple{Any, Any, Any}"><code>Skylight.circular_geodesic_angular_speed</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">circular_geodesic_angular_speed(position, spacetime, rotation_sense::AbstractRotationSense)</code></pre><p>Angular speed of a circular geodesic at the given position in the given spacetime for a particle rotating in the given sense.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/spacetimes/spacetimes.jl#L60-L65">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.circular_geodesic_energy-Tuple{Any, FRKerrSpacetime, AbstractRotationSense}" href="#Skylight.circular_geodesic_energy-Tuple{Any, FRKerrSpacetime, AbstractRotationSense}"><code>Skylight.circular_geodesic_energy</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Set for M=1</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/spacetimes/frkerr.jl#L112">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.circular_geodesic_specific_angular_momentum-Tuple{Any, FRKerrSpacetime, AbstractRotationSense}" href="#Skylight.circular_geodesic_specific_angular_momentum-Tuple{Any, FRKerrSpacetime, AbstractRotationSense}"><code>Skylight.circular_geodesic_specific_angular_momentum</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Set for M=1</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/spacetimes/frkerr.jl#L127">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.compose_N_times-Tuple{Any, Any, Any}" href="#Skylight.compose_N_times-Tuple{Any, Any, Any}"><code>Skylight.compose_N_times</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compose_N_times(N, f, x)</code></pre><p>Compose function <code>f</code> to the input <code>x</code> for <code>N</code> times.</p><p><strong>Arguments</strong></p><ul><li><code>N</code>: The number of times to apply the function <code>f</code>.</li><li><code>f</code>: The function to be applied.</li><li><code>x</code>: The input to the function <code>f</code>.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">matrix = rand(Bool, 5, 5)
compose_N_times(3, detect_edges, matrix)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/generated.jl#L1-L16">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.cos_angle_between_null_vectors-NTuple{4, Any}" href="#Skylight.cos_angle_between_null_vectors-NTuple{4, Any}"><code>Skylight.cos_angle_between_null_vectors</code></a> — <span class="docstring-category">Method</span></header><section><div><p>The cosine of the angle between null vectors v and w as seen by observer at normalized four-velocity u</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/geometry.jl#L38">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.cos_angle_between_vectors-NTuple{4, Any}" href="#Skylight.cos_angle_between_vectors-NTuple{4, Any}"><code>Skylight.cos_angle_between_vectors</code></a> — <span class="docstring-category">Method</span></header><section><div><p>The cosine of the angle between vectors v and w as seen by observer at normalized four-velocity</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/geometry.jl#L28">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.det2x2-Tuple{Any}" href="#Skylight.det2x2-Tuple{Any}"><code>Skylight.det2x2</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Computes the determinant of a 2x2 matrix using a closed-form formula.</p><p>Arguments:</p><ul><li>matrix: array of size (2,2) containing the input matrix.</li></ul><p>Returns: the determinant of the input matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/linearalgebra.jl#L146-L153">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.det2x2sym-Tuple{Any}" href="#Skylight.det2x2sym-Tuple{Any}"><code>Skylight.det2x2sym</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Computes the determinant of a 2x2 symmetric matrix using a closed-form formula.</p><p>Arguments:</p><ul><li>matrix: array of size (2,2) containing the input symmetric matrix.</li></ul><p>Returns: the determinant of the input matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/linearalgebra.jl#L161-L168">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.det4x4sym-Tuple{Any}" href="#Skylight.det4x4sym-Tuple{Any}"><code>Skylight.det4x4sym</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Computes the determinant of a 4x4 symmetric matrix using a closed-form formula.</p><p>Arguments:</p><ul><li>matrix: array of size (4,4) containing the input symmetric matrix.</li></ul><p>Returns: the determinant of the input matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/linearalgebra.jl#L121-L128">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.detect_edges-Tuple{Int64, Union{BitMatrix, Matrix{Bool}}}" href="#Skylight.detect_edges-Tuple{Int64, Union{BitMatrix, Matrix{Bool}}}"><code>Skylight.detect_edges</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">detect_edges(N, arr)</code></pre><p>Detects values that are at distance at most N from an edge. Composes <code>detect_edges</code> to  the input <code>arr</code> for 1 to <code>N</code> times, and combines the results using an elementwise OR operation.  Each application of <code>detect_edges</code> is performed on the result of the previous application and the results are combined in succession.</p><p><strong>Arguments</strong></p><ul><li><code>N</code>::Int: The maximum number of times to apply the function <code>f</code>.</li><li><code>arr</code>::Union{Matrix{Bool}, BitMatrix}: The boolean array.</li></ul><p><strong>Example</strong></p><p><code>julia matrix = rand(Bool, 5, 5) detect_edges(3, matrix)</code>` In this example, the detect_edges function is applied 1 to 3 times to a 5x5 random Boolean matrix, and the results are combined with an OR operation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/grids.jl#L68-L87">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.detect_edges-Tuple{Union{BitMatrix, Matrix{Bool}}}" href="#Skylight.detect_edges-Tuple{Union{BitMatrix, Matrix{Bool}}}"><code>Skylight.detect_edges</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">detect_edges(arr::Array{Bool, 2})</code></pre><p>Detects edges in a two-dimensional Boolean array by comparing each element with its neighbors in all four cardinal directions (up, down, left, and right). An edge is considered to be present at a location if the Boolean value at that location is different from the value of any of its neighbors.</p><p><strong>Arguments</strong></p><ul><li><code>arr::Array{Bool, 2}</code>: a two-dimensional Boolean array.</li></ul><p><strong>Returns</strong></p><ul><li><code>Array{Bool, 2}</code>: a two-dimensional Boolean array of the same size as the input, where <code>true</code> indicates the presence of an edge and <code>false</code> indicates its absence.</li></ul><p><strong>Notes</strong></p><ul><li>This function assumes that the input array is padded with <code>false</code> (or 0) at the boundaries. You might want to add boundary condition checking or padding if your input does not meet this condition.</li><li>This function uses &quot;edge wrapping&quot; when it shifts the array, meaning the values at the edge of the array &quot;wrap around&quot; to the opposite edge. If you want a different boundary condition (such as padding with <code>false</code>), you would need to adjust the creation of the shifted arrays accordingly.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/grids.jl#L30-L48">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.emissivity_profile-Tuple{AbstractMatrix, AbstractSpacetime, AbstractAccretionDisk, LamppostCorona}" href="#Skylight.emissivity_profile-Tuple{AbstractMatrix, AbstractSpacetime, AbstractAccretionDisk, LamppostCorona}"><code>Skylight.emissivity_profile</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Assumes unit energy in the rest frame of the emitter</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/radiativemodels/lamppostcorona.jl#L28">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.energies_quotients-Tuple{AbstractMatrix, AbstractSpacetime, AbstractAccretionDisk}" href="#Skylight.energies_quotients-Tuple{AbstractMatrix, AbstractSpacetime, AbstractAccretionDisk}"><code>Skylight.energies_quotients</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Assuming all photons are emitted with unit initial energy</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/postprocess/redshift.jl#L101-L103">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.equatorial_ring_areas-Tuple{AbstractVector, AbstractSpacetime}" href="#Skylight.equatorial_ring_areas-Tuple{AbstractVector, AbstractSpacetime}"><code>Skylight.equatorial_ring_areas</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">equatorial_ring_areas(edges, spacetime)</code></pre><p>Approximate areas of the equatorial rings delimited by <code>edges</code> in <code>spacetime</code>. The spacetime must be stationary and axisymmetric. The areas are computed using the formula <code>2π*sqrt(g[2,2]*g[4,4])*Δr</code>, where <code>g</code> is the metric evaluated at the center of the ring.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/spacetimes/spacetimes.jl#L237-L245">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.event_horizon_radius-Tuple{Any}" href="#Skylight.event_horizon_radius-Tuple{Any}"><code>Skylight.event_horizon_radius</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">event_horizon_radius(spacetime)</code></pre><p>Radius of the event horizon of the given spacetime. Defined only for black hole spacetimes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/spacetimes/spacetimes.jl#L31-L35">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.horizons-Tuple{FRKerrSpacetime}" href="#Skylight.horizons-Tuple{FRKerrSpacetime}"><code>Skylight.horizons</code></a> — <span class="docstring-category">Method</span></header><section><div><p>May return negative roots</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/spacetimes/frkerr.jl#L55">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.infer_num_bins-NTuple{7, Any}" href="#Skylight.infer_num_bins-NTuple{7, Any}"><code>Skylight.infer_num_bins</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">infer_num_bins(q, at_source, start, stop, bin_size_conditioner, edge_width, camera)</code></pre><p>Infer the number of bins from the energy quotients and the bin size conditioner. It chooses the larges number of bins that satisfies that the bin size is larger than the conditioner times the maximum local variation of the energy quotients, for a given approximation of the local variation.</p><p><strong>Arguments</strong></p><ul><li><code>q</code>: Array of energy quotients.</li><li><code>at_source</code>: Array of booleans indicating whether the final position is at the source.</li><li><code>start</code>: Lower bound of the range to be binned.</li><li><code>stop</code>: Upper bound of the range to be binned.</li><li><code>bin_size_conditioner</code>: Conditioner of the bin size.</li><li><code>edge_width</code>: Width of the edge to be ignored for bin size conditioning (since edges have unusually large local variations, especially in the presence of light-rings and similar phenomena).</li><li><code>camera</code>: Image plane.</li></ul><p><strong>Returns</strong></p><ul><li><code>num_bins</code>: Number of bins.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/bins.jl#L166-L185">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.initialize-Tuple{PinholeCamera, Skylight.AbstractOTEConfigurations}" href="#Skylight.initialize-Tuple{PinholeCamera, Skylight.AbstractOTEConfigurations}"><code>Skylight.initialize</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Sets the bundle of rays at the camera position. The rays are initialized on a tetrad which has a static four-velocity and  a spherical-like spatial triad. The rays have unit energy in this tetrad.  See docs/pinholecamera.md for more details</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/initialdata/observertoemitter/pinholecamera.jl#L1-L4">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.instantiate_custom_type-Tuple{Dict{Symbol}}" href="#Skylight.instantiate_custom_type-Tuple{Dict{Symbol}}"><code>Skylight.instantiate_custom_type</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">instantiate_custom_type(dict)</code></pre><p>Create an instance of a custom type using a dictionary. This version supports custom types created using the <code>@with_kw</code> macro from the Parameters.jl package and handles nested dictionaries. The dictionary and its nested subdictionaries must contain a <code>_typename</code> key whose value is the name of the custom type. </p><p><strong>Arguments</strong></p><ul><li><code>dict::Dict{Symbol, }</code>: A dictionary containing the custom type&#39;s name (stored in the <code>_typename</code> key) and field values.</li></ul><p><strong>Returns</strong></p><ul><li>An instance of the custom type with the field values specified in the input dictionary, including instances created from nested dictionaries.</li></ul><p><strong>Example</strong></p><p>```julia using Parameters</p><p>@with_kw struct MyNestedType     a::Int end</p><p>@with_kw struct MyTypeWithKW     b::Float64     nested::MyNestedType end</p><p>my<em>dict = Dict(:</em>typename =&gt; &quot;MyTypeWithKW&quot;,                :b =&gt; 2.0,                :nested =&gt; Dict(:_typename =&gt; &quot;MyNestedType&quot;,                                :a =&gt; 1))</p><p>my<em>instance = instantiate</em>custom<em>type(my</em>dict)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/load_hdf5.jl#L175-L208">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.inv4x4sym!-Tuple{Matrix{Float64}, Matrix{Float64}}" href="#Skylight.inv4x4sym!-Tuple{Matrix{Float64}, Matrix{Float64}}"><code>Skylight.inv4x4sym!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Computes the inverse of a 4x4 symmetric matrix using the closed-form solution for the inverse.</p><p>Arguments:</p><ul><li>inv_matrix: mutable array of size (4,4) to store the resulting inverse matrix.</li><li>matrix: array of size (4,4) containing the input symmetric matrix.</li></ul><p>Returns: nothing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/linearalgebra.jl#L68-L76">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.is_final_position_at_edge-Tuple{Any, Any}" href="#Skylight.is_final_position_at_edge-Tuple{Any, Any}"><code>Skylight.is_final_position_at_edge</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">is_final_position_at_edge(output_data, configurations)</code></pre><p>Determine whether the final position of each ray is at the edge of the source for a given set of configurations.</p><p><strong>Arguments</strong></p><ul><li><code>output_data</code>: a multi-dimensional array containing output data for each ray.</li><li><code>configurations</code>: a data structure containing the spacetime and radiative model configurations.</li></ul><p><strong>Returns</strong></p><p>A boolean grid indicating whether each ray&#39;s final position is at the edge of the source.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/postprocess/finalpositions.jl#L28-L39">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.is_final_position_at_edge-Tuple{Int64, Any, Any}" href="#Skylight.is_final_position_at_edge-Tuple{Int64, Any, Any}"><code>Skylight.is_final_position_at_edge</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">is_final_position_at_edge(width::Int, output_data, configurations)</code></pre><p>Determine whether the final position of each ray is at the edge of the source for a given set of configurations, considering a specified edge width.</p><p><strong>Arguments</strong></p><ul><li><code>width</code>: the width (in number of cells) to consider as the edge of the source.</li><li><code>output_data</code>: a multi-dimensional array containing output data for each ray.</li><li><code>configurations</code>: a data structure containing the spacetime and radiative model configurations.</li></ul><p><strong>Returns</strong></p><p>A boolean grid indicating whether each ray&#39;s final position is within the specified width of the edge of the source.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/postprocess/finalpositions.jl#L44-L56">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.is_final_position_at_observer-Tuple{Any, Any}" href="#Skylight.is_final_position_at_observer-Tuple{Any, Any}"><code>Skylight.is_final_position_at_observer</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">is_final_position_at_observer(output_data, configurations)</code></pre><p>Determine whether the final position of each ray is at the observer for a given set of configurations.</p><p><strong>Arguments</strong></p><ul><li><code>output_data</code>: a multi-dimensional array containing output data for each ray.</li><li><code>configurations</code>: a data structure containing the spacetime and radiative model configurations.</li></ul><p><strong>Returns</strong></p><p>A boolean grid indicating whether each ray&#39;s final position is at the observer.</p><p><strong>Notes</strong></p><p>The function <code>is_final_position_at_observer</code> should already be defined elsewhere, and is used within this function to check the final position of each ray.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/postprocess/finalpositions.jl#L62-L76">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.is_final_position_at_source-Tuple{AbstractMatrix, Any}" href="#Skylight.is_final_position_at_source-Tuple{AbstractMatrix, Any}"><code>Skylight.is_final_position_at_source</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">is_final_position_at_source(output_data, configurations)</code></pre><p>Determine whether the final position of each ray is at the source for a given set of configurations.</p><p><strong>Arguments</strong></p><ul><li><code>output_data</code>: a multi-dimensional array containing output data for each ray.</li><li><code>configurations</code>: a data structure containing the spacetime and radiative model configurations.</li></ul><p><strong>Returns</strong></p><p>A boolean grid indicating whether each ray&#39;s final position is at the source.</p><p><strong>Notes</strong></p><p>The function <code>is_final_position_at_source</code> should already be defined elsewhere, and is used within this function to check the final position of each ray.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/postprocess/finalpositions.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.is_hdf5_supported_type-Tuple{Any}" href="#Skylight.is_hdf5_supported_type-Tuple{Any}"><code>Skylight.is_hdf5_supported_type</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">is_hdf5_supported_type(value)</code></pre><p>Check if a given value is of a type that can be directly saved using the HDF5.jl package. This function can be used to determine whether a custom type or one of its fields can be saved to an HDF5 file without further conversion.</p><p>According to the HDF5.jl documentation, the supported types include:</p><ul><li>Signed and unsigned integers (8, 16, 32, and 64 bits)</li><li>Float32 and Float64</li><li>Complex versions of numeric types</li><li>Arrays of supported numeric types (including complex versions)</li><li>AbstractString (ASCIIString and UTF8String)</li><li>Arrays of supported string types (ASCIIString and UTF8String)</li></ul><p><strong>Arguments</strong></p><ul><li><code>value</code>: The value to be checked for HDF5 support.</li></ul><p><strong>Returns</strong></p><ul><li>A <code>Bool</code> indicating whether the input value is of a type supported by HDF5.jl.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/save_hdf5.jl#L314-L332">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.isco_radius-Tuple{Any, Any}" href="#Skylight.isco_radius-Tuple{Any, Any}"><code>Skylight.isco_radius</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">isco_radius(spacetime, rotation_sense::AbstractRotationSense)</code></pre><p>Radius of the innermost stable circular orbit in the given spacetime and rotation sense (prograde or  retrograde), if defined.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/spacetimes/spacetimes.jl#L40-L45">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.isco_radius-Tuple{FRKerrSpacetime, AbstractRotationSense}" href="#Skylight.isco_radius-Tuple{FRKerrSpacetime, AbstractRotationSense}"><code>Skylight.isco_radius</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Set for M=1</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/spacetimes/frkerr.jl#L142">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.line_emission_spectrum-Tuple{Any, Any, VacuumOTEConfigurations}" href="#Skylight.line_emission_spectrum-Tuple{Any, Any, VacuumOTEConfigurations}"><code>Skylight.line_emission_spectrum</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">line_emission_spectrum(initial_data, output_data, configurations::VacuumOTEConfigurations; 
                       bin_size::Number=NaN, num_bins::Int=NaN,
                       start::Number=NaN, stop::Number=NaN)</code></pre><p>Compute the binned intensity of a line emission spectrum.</p><p><strong>Arguments</strong></p><ul><li><code>initial_data</code>: Initial condition data.</li><li><code>output_data</code>: Output data from the radiation model.</li><li><code>configurations::VacuumOTEConfigurations</code>: Configuration parameters for the model.</li></ul><p><strong>Keywords</strong></p><ul><li><code>bin_size::Union{Nothing, Number}=nothing</code>: Size of each bin. Either <code>bin_size</code> or <code>num_bins</code> must be specified.</li><li><code>num_bins::Union{Nothing, Number}=nothing</code>: Number of bins. Either <code>bin_size</code> or <code>num_bins</code> must be specified.</li><li><code>start::Union{Nothing, Number}=nothing</code>: Lower bound of the range to be binned. If unspecified, the minimum of the energy quotients will be used.</li><li><code>stop::Union{Nothing, Number}=nothing</code>: Upper bound of the range to be binned. If unspecified, the maximum of the energy quotients will be used.</li><li><code>observer_four_velocity::AbstractVector</code> (optional): The four-velocity of the observer. If not provided, a default static four-velocity will be used.</li><li><code>flux_direction::AbstractVector</code> (optional): The direction in which to measure the flu. If not provided, a default direction will be used.</li></ul><p><strong>Returns</strong></p><ul><li><code>binned_fluxes</code>: Array of the binned intensity in each bin.</li><li><code>bins</code>: Array of the bin edges.</li></ul><p><strong>Notes</strong></p><p><code>observer_four_velocity</code> and <code>flux_direction</code> are only accepted if <code>configurations.camera</code> is a <code>PinholeCamera</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/postprocess/lineemission.jl#L1-L27">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.load_callback_params_from_hdf5-Tuple{String, Int64}" href="#Skylight.load_callback_params_from_hdf5-Tuple{String, Int64}"><code>Skylight.load_callback_params_from_hdf5</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">load_callback_params_from_hdf5(filename::String, run_index::Int)</code></pre><p>Load the callback parameters of a specific run from an HDF5 file and instantiate the custom type if possible.</p><p><strong>Arguments</strong></p><ul><li><code>filename</code>: The path to the HDF5 file.</li><li><code>run_index</code>: The index of the run to load the callback parameters from.</li></ul><p><strong>Returns</strong></p><ul><li>An instance of the custom type representing the callback parameters, or a dictionary if the custom type cannot be instantiated.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/load_hdf5.jl#L114-L127">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.load_configurations_from_hdf5-Tuple{String}" href="#Skylight.load_configurations_from_hdf5-Tuple{String}"><code>Skylight.load_configurations_from_hdf5</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">load_configurations_from_hdf5(filename::String)</code></pre><p>Load configurations data from an HDF5 file.</p><p><strong>Arguments</strong></p><ul><li><code>filename::String</code>: The path to the HDF5 file.</li></ul><p><strong>Returns</strong></p><ul><li>An instance of the configuration type containing the configurations data stored in the HDF5 file.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/load_hdf5.jl#L18-L28">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.load_initial_data_from_hdf5-Tuple{String}" href="#Skylight.load_initial_data_from_hdf5-Tuple{String}"><code>Skylight.load_initial_data_from_hdf5</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">load_initial_data_from_hdf5(filename::String)</code></pre><p>Load initial data from an HDF5 file.</p><p><strong>Arguments</strong></p><ul><li><code>filename::String</code>: The path to the HDF5 file.</li></ul><p><strong>Returns</strong></p><ul><li>The initial data stored in the HDF5 file.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/load_hdf5.jl#L1-L11">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.load_nested_dict_from_hdf5-Tuple{HDF5.Group}" href="#Skylight.load_nested_dict_from_hdf5-Tuple{HDF5.Group}"><code>Skylight.load_nested_dict_from_hdf5</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">load_nested_dict_from_hdf5(group::HDF5Group)</code></pre><p>Convert an HDF5 group to a dictionary. If the value is &quot;nothing&quot;, the value in the dict will be <code>nothing</code>.</p><p><strong>Arguments</strong></p><ul><li><code>group::HDF5Group</code>: The HDF5 group to convert to a dictionary.</li></ul><p><strong>Returns</strong></p><ul><li>A dictionary containing the data stored in the HDF5 group.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/load_hdf5.jl#L244-L254">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.load_output_data_from_hdf5-Tuple{String, Int64}" href="#Skylight.load_output_data_from_hdf5-Tuple{String, Int64}"><code>Skylight.load_output_data_from_hdf5</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">load_output_data_from_hdf5(filename::String, run_index::Int)</code></pre><p>Load the output data of a specific run from an HDF5 file.</p><p><strong>Arguments</strong></p><ul><li><code>filename</code>: The path to the HDF5 file.</li><li><code>run_index</code>: The index of the run to load the output data from.</li></ul><p><strong>Returns</strong></p><ul><li>The output data of the specified run.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/load_hdf5.jl#L94-L105">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.load_output_data_from_hdf5-Tuple{String, Vector{Int64}}" href="#Skylight.load_output_data_from_hdf5-Tuple{String, Vector{Int64}}"><code>Skylight.load_output_data_from_hdf5</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">load_output_data_from_hdf5(filename::String, run_indices::Vector{Int})</code></pre><p>Load output data for a selected set of runs from an HDF5 file.</p><p><strong>Arguments</strong></p><ul><li><code>filename::String</code>: The path to the HDF5 file.</li><li><code>run_indices::Vector{Int}</code>: A vector of integers indicating which runs&#39; output data to load.</li></ul><p><strong>Returns</strong></p><ul><li>An array containing the output data for the selected runs.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/load_hdf5.jl#L70-L81">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.load_runs_from_hdf5-Tuple{String, Vector{Int64}}" href="#Skylight.load_runs_from_hdf5-Tuple{String, Vector{Int64}}"><code>Skylight.load_runs_from_hdf5</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">load_runs(filename::String, run_indices::Vector{Int})</code></pre><p>Load a set of runs specified by their indices from an HDF5 file.</p><p><strong>Arguments</strong></p><ul><li><code>filename</code>: The path to the HDF5 file.</li><li><code>run_indices</code>: A vector containing the indices of the runs to be loaded.</li></ul><p><strong>Returns</strong></p><ul><li>A vector of tuples, each containing the output<em>data, callback dictionary, callback</em>parameters, and kwargs dictionary for the specified runs.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/load_hdf5.jl#L38-L50">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.lorentz_factors-Tuple{AbstractMatrix, AbstractSpacetime, AbstractRadiativeModel}" href="#Skylight.lorentz_factors-Tuple{AbstractMatrix, AbstractSpacetime, AbstractRadiativeModel}"><code>Skylight.lorentz_factors</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">lorentz_factors(positions, spacetime, model)

Lorentz factors of the rest frame four velocities of `model` at given `positions`.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/radiativemodels/radiativemodels.jl#L180-L184">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.mbco_radius-Tuple{Any, Any}" href="#Skylight.mbco_radius-Tuple{Any, Any}"><code>Skylight.mbco_radius</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">mbco_radius(spacetime, rotation_sense::AbstractRotationSense)</code></pre><p>Radius of the marginally bound circular orbit in the given spacetime and rotation sense (prograde or retrograde), if defined.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/spacetimes/spacetimes.jl#L50-L55">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.mbco_radius-Tuple{FRKerrSpacetime, AbstractRotationSense}" href="#Skylight.mbco_radius-Tuple{FRKerrSpacetime, AbstractRotationSense}"><code>Skylight.mbco_radius</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Set for M=1</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/spacetimes/frkerr.jl#L154">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.metric!-NTuple{4, Any}" href="#Skylight.metric!-NTuple{4, Any}"><code>Skylight.metric!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">metric!(g, position, spacetime, cache)</code></pre><p>Evaluate the spacetime metric at the given position and store the result in the given array using cache for temporary storage.  </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/spacetimes/spacetimes.jl#L6-L10">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.metric!-Tuple{Any, Any, RARSpacetime}" href="#Skylight.metric!-Tuple{Any, Any, RARSpacetime}"><code>Skylight.metric!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>&quot;Ruffini-Arguelles-Rueda metric for dark-matter halo</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/spacetimes/rar.jl#L45">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.metric-Tuple{Any, AbstractSpacetime, Any}" href="#Skylight.metric-Tuple{Any, AbstractSpacetime, Any}"><code>Skylight.metric</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">metric(position, spacetime, cache)</code></pre><p>Evaluate the spacetime metric at the given position and return the result using a cache object as temporary storage. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/spacetimes/spacetimes.jl#L176-L180">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.metric-Tuple{Any, AbstractSpacetime}" href="#Skylight.metric-Tuple{Any, AbstractSpacetime}"><code>Skylight.metric</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">metric(position, spacetime)</code></pre><p>Evaluate the spacetime metric at the given position and return the result. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/spacetimes/spacetimes.jl#L164-L168">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.metric_inverse!-Tuple{Any, Any, AbstractSpacetime, Any, Any}" href="#Skylight.metric_inverse!-Tuple{Any, Any, AbstractSpacetime, Any, Any}"><code>Skylight.metric_inverse!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">metric_inverse!(ginv, position, spacetime, g, cache)</code></pre><p>Evaluate the inverse of the metric at the given position  and store the result in the given array, using <code>g</code> and <code>cache</code> for temporary storage. Unless a more specialized method is defined, a fast inversion method for 4x4 symmetric matrices is used.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/spacetimes/spacetimes.jl#L90-L95">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.metric_jacobian!-Tuple{Any, Any, AbstractSpacetime, Any, Any}" href="#Skylight.metric_jacobian!-Tuple{Any, Any, AbstractSpacetime, Any, Any}"><code>Skylight.metric_jacobian!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">metric_jacobian!(∂g, position, spacetime::AbstractSpacetime, g)</code></pre><p>Computes the Jacobian matrix of the metric function with respect to spacetime coordinates using forward-mode automatic differentiation.</p><p>Arguments:</p><ul><li>∂g: mutable array of size (4,4,4) to store the resulting Jacobian matrix.</li><li>position: tuple of four numbers representing a position in spacetime.</li><li>spacetime: object representing the spacetime.</li><li>g: array of size (4,4) containing the metric evaluated at the given position.</li></ul><p>Returns: nothing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/spacetimes/autodiff.jl#L62-L74">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.metric_jacobian!-Tuple{Any, Any, Function, Any, ForwardDiff.JacobianConfig}" href="#Skylight.metric_jacobian!-Tuple{Any, Any, Function, Any, ForwardDiff.JacobianConfig}"><code>Skylight.metric_jacobian!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">metric_jacobian!(∂g, position, spacetime_metric_field::Function, g, cfg::ForwardDiff.JacobianConfig)</code></pre><p>Computes the Jacobian matrix of the metric function with respect to spacetime coordinates using forward-mode automatic differentiation.</p><p>Arguments:</p><ul><li>∂g: mutable array of size (4,4,4) to store the resulting Jacobian matrix.</li><li>position: tuple of four numbers representing a position in spacetime.</li><li>spacetime: object representing the spacetime.</li><li>g: array of size (4,4) containing the metric evaluated at the given position.</li><li>cfg: object of type ForwardDiff.JacobianConfig with preallocated work buffers </li></ul><p>Returns: nothing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/spacetimes/autodiff.jl#L80-L93">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.midpoints-Tuple{AbstractVector}" href="#Skylight.midpoints-Tuple{AbstractVector}"><code>Skylight.midpoints</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">midpoints(edges)</code></pre><p>Returns midpoints of given edges</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/bins.jl#L197-L201">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.observed_bolometric_intensities-Tuple{AbstractMatrix, AbstractMatrix, VacuumOTEConfigurations, PinholeCamera}" href="#Skylight.observed_bolometric_intensities-Tuple{AbstractMatrix, AbstractMatrix, VacuumOTEConfigurations, PinholeCamera}"><code>Skylight.observed_bolometric_intensities</code></a> — <span class="docstring-category">Method</span></header><section><div><p>observed<em>bolometric</em>intensities(initial<em>data, output</em>data, configurations::VacuumOTEConfigurations, camera::PinholeCamera; observer<em>four</em>velocity=nothing) </p><p>Compute observed bolometric intensities and energy quotients for a set of rays defined by the initial and final conditions. The function also checks whether the final position of each ray is at the source, in which case it proceeds with computation, else it skips to the next ray and the values are set to zero. </p><pre><code class="nohighlight hljs"># Arguments</code></pre><ul><li><code>initial_data::AbstractMatrix</code>: A matrix containing the initial data of the rays. The first four entries for each ray represent the initial position, while entries five to eight represent the initial momentum.</li><li><code>output_data::AbstractMatrix</code>: A matrix containing the final data of the rays. The first four entries for each ray represent the final position, while entries five to eight represent the final momentum.</li><li><code>configurations::VacuumOTEConfigurations</code>: The configurations with which the initial and output data were obtained.</li><li><code>camera::PinholeCamera</code>: The camera model used to capture the scene.</li><li><code>observer_four_velocity::AbstractVector</code> (optional): The four-velocity of the observer. If not provided, a default static four-velocity will be used.</li></ul><p><strong>Returns</strong></p><ul><li><code>Iobs::Vector</code>: A vector of observed bolometric intensities for each ray, normalized by the distance to the image plane. The intensities are in CGS units.</li><li><code>q::Vector</code>: A vector of energy quotients for each ray, representing the ratio of final energy in the local emission frame to initial energy in the observer frame.</li></ul><p><strong>Notes</strong></p><pre><code class="nohighlight hljs">Output units are CGS. The observer four-velocity and flux direction, if provided, must satisfy the conditions of being timelike and spacelike, respectively, as per the observer metric.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/postprocess/intensities.jl#L97-L115">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.observed_specific_intensities-Tuple{AbstractMatrix, AbstractMatrix, VacuumOTEConfigurations, ImagePlane, AbstractVector}" href="#Skylight.observed_specific_intensities-Tuple{AbstractMatrix, AbstractMatrix, VacuumOTEConfigurations, ImagePlane, AbstractVector}"><code>Skylight.observed_specific_intensities</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">observed_specific_intensities(initial_data, output_data, configurations::VacuumOTEConfigurations)</code></pre><p>Compute observed specific intensities and energy quotients for a set of rays defined by the initial and final conditions. The function also checks whether the final position of each ray is at the source, in which case it proceeds with computation, else it skips to the next ray and the values are set to zero.</p><p><strong>Arguments</strong></p><ul><li><code>initial_data::AbstractMatrix</code>: A matrix containing the initial data of the rays. The first four entries for each ray represent the initial position, while entries five to eight represent the initial momentum.</li><li><code>output_data::AbstractMatrix</code>: A matrix containing the final data of the rays. The first four entries for each ray represent the final position, while entries five to eight represent the final momentum.</li><li><code>configurations::VacuumOTEConfigurations</code>: The configurations with which the initial and output data were obtained.</li><li><code>observation_energies::Vector</code>: A vector of energies in CGS units at which the specific intensities are to be computed.</li></ul><p><strong>Returns</strong></p><ul><li><code>Iobs::Vector</code>: A vector of observed specific intensities in CGS units for each ray, normalized by the distance to the image plane. The intensities are in CGS units.</li><li><code>q::Vector</code>: A vector of energy quotients for each ray, representing the ratio of final energy in the local emisison frame to initial energy in the observer frame.</li></ul><p><strong>Notes</strong></p><pre><code class="nohighlight hljs">Input energy units must be CGS. Output units are CGS.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/postprocess/intensities.jl#L167-L184">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.observed_specific_intensities-Tuple{AbstractMatrix, AbstractMatrix, VacuumOTEConfigurations, PinholeCamera, Any}" href="#Skylight.observed_specific_intensities-Tuple{AbstractMatrix, AbstractMatrix, VacuumOTEConfigurations, PinholeCamera, Any}"><code>Skylight.observed_specific_intensities</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">observed_specific_intensities(initial_data, output_data, configurations::VacuumOTEConfigurations, observation_energies; observer_four_velocity=nothing)</code></pre><p>Compute observed specific intensities and energy quotients for a set of rays defined by the initial and final conditions. The function also checks whether the final position of each ray is at the source, in which case it proceeds with computation, else it skips to the next ray and the values are set to zero.</p><p><strong>Arguments</strong></p><ul><li><code>initial_data::AbstractMatrix</code>: A matrix containing the initial data of the rays. The first four entries for each ray represent the initial position, while entries five to eight represent the initial momentum.</li><li><code>output_data::AbstractMatrix</code>: A matrix containing the final data of the rays. The first four entries for each ray represent the final position, while entries five to eight represent the final momentum.</li><li><code>configurations::VacuumOTEConfigurations</code>: The configurations with which the initial and output data were obtained.</li><li><code>observation_energies::Vector</code>: A vector of energies in CGS units at which the specific intensities are to be computed.</li><li><code>observer_four_velocity::AbstractVector</code> (optional): The four-velocity of the observer. If not provided, a default static four-velocity will be used.</li></ul><p><strong>Returns</strong></p><ul><li><code>Iobs::Matrix</code>: A matrix of observed specific intensities in CGS units for each ray, normalized by the distance to the image plane. The intensities are in CGS units.</li><li><code>q::Vector</code>: A vector of energy quotients for each ray, representing the ratio of final energy in the local emission frame to initial energy in the observer frame.</li></ul><p><strong>Notes</strong></p><pre><code class="nohighlight hljs">Input energy units must be CGS. Output units are CGS. The observer four-velocity and flux direction, if provided, must satisfy the conditions of being timelike and spacelike, respectively, as per the observer metric.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/postprocess/intensities.jl#L238-L256">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.orthogonal_projection-Tuple{Any, Any, Any}" href="#Skylight.orthogonal_projection-Tuple{Any, Any, Any}"><code>Skylight.orthogonal_projection</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Projection of v orthogonal to normalized timelike vector u</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/geometry.jl#L25">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.orthonormalize!-NTuple{4, Any}" href="#Skylight.orthonormalize!-NTuple{4, Any}"><code>Skylight.orthonormalize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">orthonormalize!(dyad::Matrix, time_vector::Vector, space_vector::Vector, metric)

Orthonormalize the dyad `dyad` with respect to the metric `metric` and the vectors `time_vector` and `space_vector`.
Both `time_vector` and `space_vector` are assumed to be normalized and orthogonal to each other.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/tetrads.jl#L73-L78">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.orthonormalize!-Tuple{Any, Any, Any}" href="#Skylight.orthonormalize!-Tuple{Any, Any, Any}"><code>Skylight.orthonormalize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">orthonormalize!(triad::Matrix, time_vector::Vector, metric)

Orthonormalize the triad `triad` with respect to the metric `metric` and the vector `time_vector`.
`time_vector` is assumed to be normalized.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/tetrads.jl#L96-L101">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.outermost_circular_orbit_radius-Tuple{FRKerrSpacetime, AbstractRotationSense}" href="#Skylight.outermost_circular_orbit_radius-Tuple{FRKerrSpacetime, AbstractRotationSense}"><code>Skylight.outermost_circular_orbit_radius</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Just return 100M, this if for ion torus</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/spacetimes/frkerr.jl#L176">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.packets_tetrad_components!-Tuple{Any, Any}" href="#Skylight.packets_tetrad_components!-Tuple{Any, Any}"><code>Skylight.packets_tetrad_components!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>By having Minkowski-null components in the tetrad we guarantee that the momentum is null</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/initialdata/emittertoobserver/emittertoobserver.jl#L63">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.packets_unit_random_triad_components!-Tuple{Any, Skylight.IsOpaqueInteriorSurface}" href="#Skylight.packets_unit_random_triad_components!-Tuple{Any, Skylight.IsOpaqueInteriorSurface}"><code>Skylight.packets_unit_random_triad_components!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Sets only positive components along the surface normal</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/initialdata/emittertoobserver/emittertoobserver.jl#L77">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.planck_function-Tuple{Any, Any}" href="#Skylight.planck_function-Tuple{Any, Any}"><code>Skylight.planck_function</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">planck_function(E, T)</code></pre><p>Planck&#39;s law of black body radiation in terms of energy.</p><p><strong>Arguments</strong></p><ul><li><code>E::Float64</code>: The energy in erg.</li><li><code>T::Float64</code>: The temperature in Kelvin.</li></ul><p><strong>Returns</strong></p><ul><li><code>::Float64</code>: The planck function in CGS.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/radiativemodels/radiativeprocesses/thermalemission.jl#L12-L23">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.planck_integral-Tuple{Any, Any}" href="#Skylight.planck_integral-Tuple{Any, Any}"><code>Skylight.planck_integral</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">planck_integral(E, T)</code></pre><p>Estimation of the Planck integral from E to infinity for temperature T.  Based on &quot;Planck functions and integrals; methods of computation&quot; (T.E. Michels) https://ntrs.nasa.gov/archive/nasa/casi.ntrs.nasa.gov/19680008986.pdf</p><p><strong>Arguments</strong></p><ul><li><code>E::Float64</code>: The energy in erg.</li><li><code>T::Float64</code>: The temperature in Kelvin.</li></ul><p><strong>Returns</strong></p><ul><li><code>::Float64</code>: The planck integral in CGS.</li></ul><p><strong>Remarks</strong></p><p>An evaluation of the error is too expensive for millions of calls, so we fix N=5. This was checked against scipy integration, yielding at least 3 siginficant digits for all x. When x&gt;1 the amount of siginificant digits is 8 or more</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/radiativemodels/radiativeprocesses/thermalemission.jl#L31-L49">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.points_on_equatorial_plane!-Tuple{Any, Any, Any, CartesianTopology}" href="#Skylight.points_on_equatorial_plane!-Tuple{Any, Any, Any, CartesianTopology}"><code>Skylight.points_on_equatorial_plane!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">points_on_equatorial_plane!(points, r, φ, ::CartesianTopology)</code></pre><p>Sets the points on the equatorial plane from spherical coordinates</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/randompoints.jl#L104-L108">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.points_on_unit_sphere!-Tuple{Any, Any, Any, CartesianTopology}" href="#Skylight.points_on_unit_sphere!-Tuple{Any, Any, Any, CartesianTopology}"><code>Skylight.points_on_unit_sphere!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">points_on_unit_sphere!(points, θ, φ, ::AbstractCoordinatesTopology)</code></pre><p>Transforms the points on the unit sphere from the angular coordinates</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/randompoints.jl#L126-L130">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.radius-Tuple{Any, Any}" href="#Skylight.radius-Tuple{Any, Any}"><code>Skylight.radius</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">radius(position, spacetime)</code></pre><p>Radius of the given position in the given spacetime. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/spacetimes/spacetimes.jl#L24-L28">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.radius-Tuple{Any, SchwarzschildSpacetimeKerrSchildCoordinates}" href="#Skylight.radius-Tuple{Any, SchwarzschildSpacetimeKerrSchildCoordinates}"><code>Skylight.radius</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">radius(position, spacetime::SchwarzschildSpacetimeKerrSchildCoordinates)

``r = \sqrt{x^2 + y^2 + z^2}``</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/spacetimes/schwarzschild.jl#L25-L29">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.random_azimuthal_angle-Tuple{Any}" href="#Skylight.random_azimuthal_angle-Tuple{Any}"><code>Skylight.random_azimuthal_angle</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">random_azimuthal_angle(N)</code></pre><p>Generates <code>N</code> random numbers representing azimuthal angles, following a  uniform distribution from 0 to 2π.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/randompoints.jl#L96-L101">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.random_cylindrical_radius-Tuple{Any, Any, Any}" href="#Skylight.random_cylindrical_radius-Tuple{Any, Any, Any}"><code>Skylight.random_cylindrical_radius</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">random_cylindrical_radius(N, rmin, rmax)</code></pre><p>Generates <code>N</code> random numbers representing cylindrical radii, following a  uniform distribution between <code>rmin</code> and <code>rmax</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/randompoints.jl#L80-L85">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.random_polar_angle-Tuple{Any, Any}" href="#Skylight.random_polar_angle-Tuple{Any, Any}"><code>Skylight.random_polar_angle</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">random_polar_angle(N, θmax)</code></pre><p>Generates <code>N</code> random numbers representing polar angles, following a  uniform distribution from 0 to <code>θmax</code> (in radians).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/randompoints.jl#L88-L93">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.random_uniform_points_annulus!-NTuple{4, Any}" href="#Skylight.random_uniform_points_annulus!-NTuple{4, Any}"><code>Skylight.random_uniform_points_annulus!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">random_uniform_points_annulus!(points, rmin, rmax, coords_top)</code></pre><p>Populate the given array <code>points</code> with points randomly and uniformly  distributed in an annulus with inner radius <code>rmin</code> and outer radius <code>rmax</code>. The type of the coordinate system is determined by <code>coords_top</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/randompoints.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.random_uniform_points_disk!-Tuple{Any, Any, Any}" href="#Skylight.random_uniform_points_disk!-Tuple{Any, Any, Any}"><code>Skylight.random_uniform_points_disk!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">random_uniform_points_disk!(points, rmax, coords_top)</code></pre><p>Populate the given array <code>points</code> with points randomly and uniformly  distributed in a disk with radius <code>rmax</code>. The type of the coordinate system is determined by <code>coords_top</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/randompoints.jl#L16-L22">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.random_uniform_points_unit_hemisphere!-Tuple{Any, Any}" href="#Skylight.random_uniform_points_unit_hemisphere!-Tuple{Any, Any}"><code>Skylight.random_uniform_points_unit_hemisphere!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">random_uniform_points_unit_hemisphere!(points, coords_top)</code></pre><p>Populate the given array <code>points</code> with points randomly and uniformly  distributed on the unit hemisphere. The type of the coordinate system is determined by <code>coords_top</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/randompoints.jl#L56-L62">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.random_uniform_points_unit_hemisphere_xaxis!-Tuple{Any, CartesianTopology}" href="#Skylight.random_uniform_points_unit_hemisphere_xaxis!-Tuple{Any, CartesianTopology}"><code>Skylight.random_uniform_points_unit_hemisphere_xaxis!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">random_uniform_points_unit_hemisphere_xaxis!(v,::CartesianTopology)</code></pre><p>Populate the given array <code>v</code> with points randomly and uniformly  distributed on the unit hemisphere along the x-axis.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/randompoints.jl#L68-L73">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.random_uniform_points_unit_sphere!-Tuple{Any, Any}" href="#Skylight.random_uniform_points_unit_sphere!-Tuple{Any, Any}"><code>Skylight.random_uniform_points_unit_sphere!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">random_uniform_points_unit_sphere!(points, coords_top)</code></pre><p>Populate the given array <code>points</code> with points randomly and uniformly  distributed on the unit sphere. The type of the coordinate system is determined by <code>coords_top</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/randompoints.jl#L44-L50">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.random_uniform_points_unit_spherical_cap!-Tuple{Any, Any, Any}" href="#Skylight.random_uniform_points_unit_spherical_cap!-Tuple{Any, Any, Any}"><code>Skylight.random_uniform_points_unit_spherical_cap!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">random_uniform_points_unit_spherical_cap!(points, θmax_in_degrees, coords_top)</code></pre><p>Populate the given array <code>points</code> with points randomly and uniformly  distributed in a spherical cap with maximum polar angle <code>θmax_in_degrees</code> degrees. The type of the coordinate system is determined by <code>coords_top</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/randompoints.jl#L28-L34">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.rayleigh_jeans_function-Tuple{Any, Any}" href="#Skylight.rayleigh_jeans_function-Tuple{Any, Any}"><code>Skylight.rayleigh_jeans_function</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rayleigh_jeans_function(E, T)</code></pre><p>Rayleigh-Jeans law of black body radiation in terms of energy.</p><p><strong>Arguments</strong></p><ul><li><code>E::Float64</code>: The energy in erg.</li><li><code>T::Float64</code>: The temperature in Kelvin.</li></ul><p><strong>Returns</strong></p><ul><li><code>::Float64</code>: The Rayleigh-Jeans function in CGS.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/radiativemodels/radiativeprocesses/thermalemission.jl#L65-L76">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.rays_tetrad_components!-Tuple{Any, PinholeCamera}" href="#Skylight.rays_tetrad_components!-Tuple{Any, PinholeCamera}"><code>Skylight.rays_tetrad_components!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>By having Minkowski-null components in the tetrad we guarantee that the momentum is null</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/initialdata/observertoemitter/pinholecamera.jl#L35">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.save_nested_dict_to_hdf5-Tuple{Any, Any}" href="#Skylight.save_nested_dict_to_hdf5-Tuple{Any, Any}"><code>Skylight.save_nested_dict_to_hdf5</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">save_nested_dict_to_hdf5(group::HDF5File, nested_dict::Dict{Symbol,})</code></pre><p>Recursively save a nested dictionary to an HDF5 group. The function iterates through the key-value pairs in the input dictionary. If a value is a dictionary, it creates a new subgroup and recursively saves the nested dictionary. If a value is not a dictionary, it is saved directly to the current group.</p><p><strong>Arguments</strong></p><ul><li><code>group</code>: An HDF5 group to which the nested dictionary should be saved.</li><li><code>nested_dict</code>: A nested dictionary with keys of type <code>Symbol</code> and values of any type.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/save_hdf5.jl#L138-L146">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.save_obj_to_hdf5-Tuple{Any, Any, Any}" href="#Skylight.save_obj_to_hdf5-Tuple{Any, Any, Any}"><code>Skylight.save_obj_to_hdf5</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">save_obj_to_hdf5(group::HDF5File, name::String, obj::Any)</code></pre><p>Save an object to an HDF5 group by converting it to an HDF5 compatible dictionary and then saving the dictionary to the group. The function creates a new subgroup with the given name and saves the converted dictionary using the <code>save_nested_dict_to_hdf5</code> function.</p><p><strong>Arguments</strong></p><ul><li><code>group</code>: An HDF5 group to which the object should be saved.</li><li><code>name</code>: A string representing the name of the subgroup to create for the object.</li><li><code>obj</code>: An object of any type that should be saved to the HDF5 group.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/save_hdf5.jl#L122-L131">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.save_to_hdf5-Union{Tuple{T}, Tuple{String, AbstractConfigurations, Array, Array{T}}} where T&lt;:Skylight.Run" href="#Skylight.save_to_hdf5-Union{Tuple{T}, Tuple{String, AbstractConfigurations, Array, Array{T}}} where T&lt;:Skylight.Run"><code>Skylight.save_to_hdf5</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">save_to_hdf5(filename, configurations, initial_data, runs)</code></pre><p>Save the provided data to an HDF5 file. The data includes configurations, initial<em>data, and a collection of runs. Each run contains output</em>data, callback, callback_parameters, and kwargs for the solver function.</p><p>If the file exists, it uses the &quot;r+&quot; mode to open the file for reading and writing. If the file does not exist, it uses the &quot;w&quot; mode to create a new file.</p><p>The file will be organized as follows:</p><ul><li>/configurations: A group containing the configurations data.</li><li>/initial_data: A dataset containing the initial data.</li><li>/runs: A group containing subgroups for each run. Each subgroup will have:<ul><li>/output_data: A dataset containing the output data.</li><li>/callback: A subgroup containing the callback custom type data.</li><li>/callback_parameters: A subgroup containing the callback parameters data.</li><li>/kwargs: A subgroup containing the kwargs data.</li></ul></li></ul><p><strong>Arguments</strong></p><ul><li><code>filename</code>: The name of the HDF5 file to save the data to. If the file already exists, new data will be appended without overwriting existing content.</li><li><code>configurations</code>: A custom type containing the configurations data. It will be converted to a dictionary using the <code>to_hdf5_compatible_dict</code> function.</li><li><code>initial_data</code>: The initial data for the equations.</li><li><code>runs</code>: An array of tuples containing output<em>data, callback custom type, callback</em>parameters, and kwargs for each run. The callback custom type and callback<em>parameters should be custom types, which will be converted to dictionaries using the `to</em>hdf5<em>compatible</em>dict` function.</li></ul><p><strong>Returns</strong></p><ul><li>Nothing.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/save_hdf5.jl#L1-L25">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.set_null!-Tuple{Any, Any}" href="#Skylight.set_null!-Tuple{Any, Any}"><code>Skylight.set_null!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>returns with unit energy</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/initialdata/observertoemitter/imageplane.jl#L109">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.set_null_ingoing_past_directed!-Tuple{Any, Any}" href="#Skylight.set_null_ingoing_past_directed!-Tuple{Any, Any}"><code>Skylight.set_null_ingoing_past_directed!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>the input time component must be zero for this to work </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/initialdata/observertoemitter/imageplane.jl#L102">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.spherical_symmetry-Tuple{AbstractSpacetime}" href="#Skylight.spherical_symmetry-Tuple{AbstractSpacetime}"><code>Skylight.spherical_symmetry</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">spherical_symmetry(spacetime)</code></pre><p>Return <code>IsSphericallySymmetric()</code> if the spacetime is spherically symmetric, <code>IsNotSphericallySymmetric()</code> otherwise.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/spacetimes/spacetimes.jl#L110-L114">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.stationarity-Tuple{AbstractSpacetime}" href="#Skylight.stationarity-Tuple{AbstractSpacetime}"><code>Skylight.stationarity</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">stationarity(spacetime)</code></pre><p>Return <code>IsStationary()</code> if the spacetime is stationary, <code>IsNotStationary()</code> otherwise.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/spacetimes/spacetimes.jl#L103-L107">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.tmap-Tuple{Any, Any, Vararg{Any}}" href="#Skylight.tmap-Tuple{Any, Any, Vararg{Any}}"><code>Skylight.tmap</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">tmap(f, itr; tasks_per_thread::Int = 2, kwargs...)</code></pre><p>Apply a given function <code>f</code> to partitions of the iterable <code>itr</code> in parallel.</p><p><strong>Arguments</strong></p><ul><li><code>f</code>: A function to be applied to each partition of the iterable.</li><li><code>itr</code>: The iterable to be partitioned and processed.</li><li><code>tasks_per_thread::Int</code>: An optional parameter to control the number of tasks per thread. Default value is 2.</li><li><code>kwargs...</code>: Additional keyword arguments that will be passed to the function <code>f</code>.</li></ul><p><strong>Description</strong></p><p>This function divides the iterable <code>itr</code> into chunks, with each chunk size determined by the given <code>tasks_per_thread</code> and the number of available threads. The specified function <code>f</code> is then applied to each chunk in parallel using the <code>@spawn</code> macro. The <code>@sync</code> macro ensures that all tasks are completed before moving on.</p><p><strong>Example</strong></p><p>```julia function print<em>elements(chunk)     for i in chunk         println(i)     end end tmap(print</em>elements, 1:10; tasks<em>per</em>thread = 2)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/multithreading.jl#L1-L23">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.to_hdf5_compatible_dict-Tuple{T} where T" href="#Skylight.to_hdf5_compatible_dict-Tuple{T} where T"><code>Skylight.to_hdf5_compatible_dict</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">to_hdf5_compatible_dict(obj::T; depth::Int=0, max_depth::Int=5) where T</code></pre><p>Recursively convert a custom type <code>obj</code> to a dictionary. This function is useful for preparing custom types for saving to an HDF5 file when the types are not directly supported by the HDF5.jl package.</p><p>The function will attempt to convert each field of the custom type to a dictionary if the field is not an HDF5-supported type. The conversion process is limited by a maximum recursion depth, specified by the <code>max_depth</code> parameter, which defaults to 5.</p><p>If a field is nothing, the value will be saved as the string &quot;nothing&quot;.</p><p>If a field is a function, the function will be converted to a string using the <code>string</code> function.</p><p>If a field is not an HDF5-supported type and has no fields that can be converted, the function will return <code>nothing</code> when the maximum recursion depth is reached.</p><p><strong>Arguments</strong></p><ul><li><code>obj::T</code>: The custom type instance to be converted to a dictionary.</li><li><code>depth::Int=0</code> (optional): The current recursion depth, starting at 0. This parameter is used internally and should not typically be set by the user.</li><li><code>max_depth::Int=5</code> (optional): The maximum recursion depth allowed for converting nested custom types.</li></ul><p><strong>Returns</strong></p><ul><li>A <code>Dict{String, Any}</code> containing the fields of the input custom type, with nested custom types recursively converted to dictionaries. The dictionary will also include a &quot;_typename&quot; key with the name of the custom type as a string.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/save_hdf5.jl#L208-L228">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.to_hdf5_compatible_dict-Tuple{T} where T&lt;:SciMLBase.DECallback" href="#Skylight.to_hdf5_compatible_dict-Tuple{T} where T&lt;:SciMLBase.DECallback"><code>Skylight.to_hdf5_compatible_dict</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">to_hdf5_compatible_dict(cb::T; depth::Int=0, max_depth::Int=8) where {T&lt;:SciMLBase.DECallback}</code></pre><p>Converts a DifferentialEquations.jl callback into a dictionary that can be saved to an HDF5 file for later instantiation.</p><p><strong>Arguments</strong></p><ul><li><code>cb</code>: The callback to be converted into a dictionary.</li><li><code>depth</code>: The current depth of recursion. This is used to prevent infinite recursion.  (default: 0)</li><li><code>max_depth</code>: The maximum allowed depth of recursion. If the <code>depth</code> exceeds this value,  the function returns <code>nothing</code>. (default: 8)</li></ul><p><strong>Returns</strong></p><ul><li>A dictionary where the keys are the names of the fields of the object and the values are  the corresponding field values. Field values are recursively converted to dictionaries  if they are of custom types not supported by HDF5.jl.</li></ul><p><strong>Notes</strong></p><ul><li>The dictionary includes an additional entry with the key &quot;_typename&quot; and the name of the type  of the object as the value. This is used to reconstruct the original object when loading  the data from the HDF5 file.</li><li>The function specifically handles certain fields of the DECallback type.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/utils/save_hdf5.jl#L258-L281">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.volume_element-Tuple{Any, AbstractSpacetime, Any, Any}" href="#Skylight.volume_element-Tuple{Any, AbstractSpacetime, Any, Any}"><code>Skylight.volume_element</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">volume_element(position, spacetime, g, cache)</code></pre><p>Compute the volume element (square root of minus the determinant of the metric) at the given position  with a fast determinant for 4x4 symmetric matrices, using <code>g</code> and <code>cache</code> for temporary storage.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/spacetimes/spacetimes.jl#L187-L192">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Skylight.volume_element-Tuple{Any, AbstractSpacetime}" href="#Skylight.volume_element-Tuple{Any, AbstractSpacetime}"><code>Skylight.volume_element</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">volume_element(position, spacetime)</code></pre><p>Compute the volume element (square root of minus the determinant of the metric) at the given position  with a fast determinant for 4x4 symmetric matrices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/df95202699222d00f82cc40583b11b6772f3ecc4/src/spacetimes/spacetimes.jl#L198-L203">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../catalogue/">« Catalogue</a><a class="docs-footer-nextpage" href="../autodiff/">Automatic differentiation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Tuesday 12 September 2023 23:31">Tuesday 12 September 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Novikov-Thorne disk around a Kerr black hole · Skylight</title><meta name="title" content="Novikov-Thorne disk around a Kerr black hole · Skylight"/><meta property="og:title" content="Novikov-Thorne disk around a Kerr black hole · Skylight"/><meta property="twitter:title" content="Novikov-Thorne disk around a Kerr black hole · Skylight"/><meta name="description" content="Documentation for Skylight."/><meta property="og:description" content="Documentation for Skylight."/><meta property="twitter:description" content="Documentation for Skylight."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Skylight logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Skylight</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../gettingstarted/">Getting started</a></li><li><span class="tocitem">Tutorials</span><ul><li class="is-active"><a class="tocitem" href>Novikov-Thorne disk around a Kerr black hole</a></li><li><a class="tocitem" href="../corona_kerr/">Lamppost corona above a Kerr black hole</a></li><li><a class="tocitem" href="../torus_kerr/">Ion torus around a Kerr black hole</a></li><li><a class="tocitem" href="../frkerr/">f(R)-Kerr black hole</a></li><li><a class="tocitem" href="../johannsen/">Johannsen black hole</a></li><li><a class="tocitem" href="../bosonstar/">Boson star</a></li><li><a class="tocitem" href="../chargedwormhole/">Star across charged wormhole</a></li><li><a class="tocitem" href="../rar/">RAR galactic core</a></li><li><a class="tocitem" href="../skylightlogo/">Skylight logo</a></li></ul></li><li><a class="tocitem" href="../../spacetimes/">Spacetimes</a></li><li><a class="tocitem" href="../../radiativemodels/">Radiative models</a></li><li><a class="tocitem" href="../../camera/">Camera</a></li><li><a class="tocitem" href="../../configurations/configurations/">Configurations</a></li><li><a class="tocitem" href="../../initialdata/">Initial data</a></li><li><a class="tocitem" href="../../radiativetransfer/radiativetransfer/">Radiative transfer</a></li><li><span class="tocitem">Postprocess</span><ul><li><a class="tocitem" href="../../postprocess/images/">Images</a></li><li><a class="tocitem" href="../../postprocess/spectra/">Spectra</a></li><li><a class="tocitem" href="../../postprocess/lineemission/">Line emission</a></li><li><a class="tocitem" href="../../postprocess/lightcurves/">Light curves</a></li></ul></li><li><span class="tocitem">Utils</span><ul><li><a class="tocitem" href="../../utils/geometry/">Geometry and linear algebra</a></li><li><a class="tocitem" href="../../utils/vectorfields/">Vector fields</a></li><li><a class="tocitem" href="../../utils/constants/">Constants</a></li><li><a class="tocitem" href="../../utils/units/">Units and dimensions</a></li></ul></li><li><span class="tocitem">Developers</span><ul><li><a class="tocitem" href="../../developers/spacetimes/">Adding a spacetime</a></li><li><a class="tocitem" href="../../developers/radiativemodels/">Adding a radiative model</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li><li><a class="tocitem" href="../../publications/">Publications</a></li><li><a class="tocitem" href="../../citing/">Citing</a></li><li><a class="tocitem" href="../../contributing/">Contributing</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Novikov-Thorne disk around a Kerr black hole</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Novikov-Thorne disk around a Kerr black hole</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/joaquinpelle/Skylight.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/joaquinpelle/Skylight.jl/blob/main/docs/src/examples/disk_kerr.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Novikov-Thorne-disk-around-a-Kerr-black-hole"><a class="docs-heading-anchor" href="#Novikov-Thorne-disk-around-a-Kerr-black-hole">Novikov-Thorne disk around a Kerr black hole</a><a id="Novikov-Thorne-disk-around-a-Kerr-black-hole-1"></a><a class="docs-heading-anchor-permalink" href="#Novikov-Thorne-disk-around-a-Kerr-black-hole" title="Permalink"></a></h1><p>In this tutorial, we will simulate the emission from a Novikov-Thorne disk around a Kerr black hole. Make sure you have installed Skylight.jl and CairoMakie.jl for visualizing the data.</p><h4 id="1.-Import-the-necessary-packages"><a class="docs-heading-anchor" href="#1.-Import-the-necessary-packages">1. Import the necessary packages</a><a id="1.-Import-the-necessary-packages-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Import-the-necessary-packages" title="Permalink"></a></h4><pre><code class="language-julia hljs">using Skylight
using CairoMakie</code></pre><h4 id="2.-Define-the-spacetime"><a class="docs-heading-anchor" href="#2.-Define-the-spacetime">2. Define the spacetime</a><a id="2.-Define-the-spacetime-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Define-the-spacetime" title="Permalink"></a></h4><p>We define the spacetime as a Kerr black hole with mass <code>M = 1.0</code> and spin <code>a = 0.9</code> in Boyer-Lindquist coordinates.</p><pre><code class="language-julia hljs">spacetime = KerrSpacetimeBoyerLindquistCoordinates(M = 1.0, a = 0.9)</code></pre><h4 id="3.-Define-the-radiative-model"><a class="docs-heading-anchor" href="#3.-Define-the-radiative-model">3. Define the radiative model</a><a id="3.-Define-the-radiative-model-1"></a><a class="docs-heading-anchor-permalink" href="#3.-Define-the-radiative-model" title="Permalink"></a></h4><p>We create a Novikov-Thorne disk in prograde rotation around the black hole, specifying the inner and outer radii of the disk. The inner radius is set to the innermost stable circular orbit (ISCO) of the black hole, which depends on the spacetime parameters and rotation sense. The accretion rate is set to 10% of the Eddington accretion rate with a radiative efficiency of 10%. The unit mass is set to <span>$10^7$</span> solar masses.</p><pre><code class="language-julia hljs">disk = NovikovThorneDisk(inner_radius=isco_radius(spacetime, ProgradeRotation()), 
    outer_radius = 1000.0, 
    M1 = 1e7, 
    Mdot_to_MEdd = 0.1, 
    η = 0.1,
    rotation_sense = ProgradeRotation())</code></pre><h4 id="4.-Set-up-the-camera"><a class="docs-heading-anchor" href="#4.-Set-up-the-camera">4. Set up the camera</a><a id="4.-Set-up-the-camera-1"></a><a class="docs-heading-anchor-permalink" href="#4.-Set-up-the-camera" title="Permalink"></a></h4><pre><code class="language-julia hljs">camera = PinholeCamera(position = [0.0, 500, π/2 - π/20, 0.0],
    horizontal_aperture_in_degrees = 4,
    vertical_aperture_in_degrees = 4,
    horizontal_number_of_pixels = 200,
    vertical_number_of_pixels = 200)</code></pre><h4 id="5.-Create-the-initial-data"><a class="docs-heading-anchor" href="#5.-Create-the-initial-data">5. Create the initial data</a><a id="5.-Create-the-initial-data-1"></a><a class="docs-heading-anchor-permalink" href="#5.-Create-the-initial-data" title="Permalink"></a></h4><pre><code class="language-julia hljs">initial_data = initialize(configurations)</code></pre><h4 id="6.-Set-up-the-callback"><a class="docs-heading-anchor" href="#6.-Set-up-the-callback">6. Set up the callback</a><a id="6.-Set-up-the-callback-1"></a><a class="docs-heading-anchor-permalink" href="#6.-Set-up-the-callback" title="Permalink"></a></h4><pre><code class="language-julia hljs">cb, cbp = callback_setup(configurations; rhorizon_bound = 2e-3) #... or, define your own cb and cbp</code></pre><h4 id="7.-Run-the-simulation"><a class="docs-heading-anchor" href="#7.-Run-the-simulation">7. Run the simulation</a><a id="7.-Run-the-simulation-1"></a><a class="docs-heading-anchor-permalink" href="#7.-Run-the-simulation" title="Permalink"></a></h4><pre><code class="language-julia hljs">run = integrate(initial_data,
    configurations,
    cb,
    cbp;
    method = VCABM(),
    reltol = 1e-8,
    abstol = 1e-8)</code></pre><h4 id="8.-Extract-the-results"><a class="docs-heading-anchor" href="#8.-Extract-the-results">8. Extract the results</a><a id="8.-Extract-the-results-1"></a><a class="docs-heading-anchor-permalink" href="#8.-Extract-the-results" title="Permalink"></a></h4><pre><code class="language-julia hljs">output_data = run.output_data
Iobs = observed_bolometric_intensities(initial_data, output_data, configurations)</code></pre><h4 id="9.-Visualize-the-results"><a class="docs-heading-anchor" href="#9.-Visualize-the-results">9. Visualize the results</a><a id="9.-Visualize-the-results-1"></a><a class="docs-heading-anchor-permalink" href="#9.-Visualize-the-results" title="Permalink"></a></h4><pre><code class="language-julia hljs">xs, ys = axes_ranges(camera)
zs = grid_view(Iobs, configurations)

fig = Figure(font = &quot;CMU Serif&quot;)
ax = Axis(fig[1, 1],
    xlabel = L&quot;\alpha&quot;,
    ylabel = L&quot;\beta&quot;,
    ylabelsize = 26,
    xlabelsize = 26)
hmap = heatmap!(xs, ys, zs / maximum(zs); colormap = :gist_heat, interpolate = true)
Colorbar(fig[:, end + 1],
    hmap,
    label = L&quot;I&quot;,
    labelsize = 26,
    width = 15,
    ticksize = 18,
    tickalign = 1)
colsize!(fig.layout, 1, Aspect(1, 1.0))
colgap!(fig.layout, 7)
CairoMakie.save(&quot;plot.png&quot;, fig)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../gettingstarted/">« Getting started</a><a class="docs-footer-nextpage" href="../corona_kerr/">Lamppost corona above a Kerr black hole »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Monday 22 July 2024 19:11">Monday 22 July 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Camera · Skylight</title><meta name="title" content="Camera · Skylight"/><meta property="og:title" content="Camera · Skylight"/><meta property="twitter:title" content="Camera · Skylight"/><meta name="description" content="Documentation for Skylight."/><meta property="og:description" content="Documentation for Skylight."/><meta property="twitter:description" content="Documentation for Skylight."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Skylight logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Skylight</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../gettingstarted/">Getting started</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../examples/disk_kerr/">Novikov-Thorne disk around a Kerr black hole</a></li><li><a class="tocitem" href="../examples/corona_kerr/">Lamppost corona above a Kerr black hole</a></li><li><a class="tocitem" href="../examples/torus_kerr/">Ion torus around a Kerr black hole</a></li><li><a class="tocitem" href="../examples/frkerr/">f(R)-Kerr black hole</a></li><li><a class="tocitem" href="../examples/johannsen/">Johannsen black hole</a></li><li><a class="tocitem" href="../examples/bosonstar/">Boson star</a></li><li><a class="tocitem" href="../examples/chargedwormhole/">Star across charged wormhole</a></li><li><a class="tocitem" href="../examples/rar/">RAR galactic core</a></li><li><a class="tocitem" href="../examples/skylightlogo/">Skylight logo</a></li></ul></li><li><a class="tocitem" href="../spacetimes/">Spacetimes</a></li><li><a class="tocitem" href="../radiativemodels/">Radiative models</a></li><li class="is-active"><a class="tocitem" href>Camera</a><ul class="internal"><li><a class="tocitem" href="#Examples"><span>Examples</span></a></li><li><a class="tocitem" href="#Types"><span>Types</span></a></li><li><a class="tocitem" href="#Details-of-the-construction"><span>Details of the construction</span></a></li></ul></li><li><a class="tocitem" href="../configurations/configurations/">Configurations</a></li><li><a class="tocitem" href="../initialdata/">Initial data</a></li><li><a class="tocitem" href="../radiativetransfer/radiativetransfer/">Radiative transfer</a></li><li><span class="tocitem">Postprocess</span><ul><li><a class="tocitem" href="../postprocess/images/">Images</a></li><li><a class="tocitem" href="../postprocess/spectra/">Spectra</a></li><li><a class="tocitem" href="../postprocess/lineemission/">Line emission</a></li><li><a class="tocitem" href="../postprocess/lightcurves/">Light curves</a></li></ul></li><li><span class="tocitem">Utils</span><ul><li><a class="tocitem" href="../utils/geometry/">Geometry and linear algebra</a></li><li><a class="tocitem" href="../utils/vectorfields/">Vector fields</a></li><li><a class="tocitem" href="../utils/constants/">Constants</a></li><li><a class="tocitem" href="../utils/units/">Units and dimensions</a></li></ul></li><li><span class="tocitem">Developers</span><ul><li><a class="tocitem" href="../developers/spacetimes/">Adding a spacetime</a></li><li><a class="tocitem" href="../developers/radiativemodels/">Adding a radiative model</a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../publications/">Publications</a></li><li><a class="tocitem" href="../citing/">Citing</a></li><li><a class="tocitem" href="../contributing/">Contributing</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Camera</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Camera</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/joaquinpelle/Skylight.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/joaquinpelle/Skylight.jl/blob/main/docs/src/camera.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Camera"><a class="docs-heading-anchor" href="#Camera">Camera</a><a id="Camera-1"></a><a class="docs-heading-anchor-permalink" href="#Camera" title="Permalink"></a></h1><p>In the observer-to-emitter method, we integrate the radiative transfer equation backwards in time starting from the observation point. For this, a bundle of past-directed rays, forming what is usually called a virtual camera, is traced from the observer to the source, . See <a href="#Pinhole-camera">Pinhole camera</a> for a detailed explanation of the camera construction and flux calculation methods.</p><h2 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h2><p>In Skylight.jl, the camera is represented by the <a href="#Skylight.PinholeCamera"><code>PinholeCamera</code></a> type containing the parameters that define the camera position, the field of view, and the resolution. The camera can be constructed as follows:</p><pre><code class="language-julia hljs">camera = PinholeCamera(position = [0.0, 500, π/2-π/20, 0.0],
                        horizontal_aperture_in_degrees = 4,
                        vertical_aperture_in_degrees = 4,
                        horizontal_number_of_pixels = 600,
                        vertical_number_of_pixels = 600)</code></pre><p>The camera position is given by the spacetime coordinates of the observation point, and must be in the same coordinates as those of the spacetime in which it is set. The apertures define the field of view, and ideally should be set to capture a full view of the emitting source. Optionally, a four-velocity can be set for the observation frame, with components given in the coordinate basis: </p><pre><code class="language-julia hljs">camera = PinholeCamera(position = [0.0, 500, π/2-π/20, 0.0],
                        horizontal_aperture_in_degrees = rad2deg(80/500),
                        vertical_aperture_in_degrees = rad2deg(80/500),
                        horizontal_number_of_pixels = 600,
                        vertical_number_of_pixels = 600,
                        four_velocity = [1.0, -0.5, 0.0, 0.0])</code></pre><p>Otherwise, the observation frame will be assumed to be the static frame.</p><p>Most ray-tracing applications use the so-called image plane instead of a pinhole camera. This is an approximation in which the spacetime is assumed to be asymptotically flat, and the observer is at a large distance from the source, such that the light rays arrive mutually parallel. Such a camera construction is available in Skylight.jl as the <a href="#Skylight.ImagePlane"><code>ImagePlane</code></a> type, and can be constructed as follows:</p><pre><code class="language-julia hljs">camera = ImagePlane(distance = 500.0,
    observer_inclination_in_degrees = 90,
    horizontal_side = 23.0,
    vertical_side = 23.0,
    horizontal_number_of_pixels = 100,
    vertical_number_of_pixels = 100,
    observation_times = [0.0, 100.0])</code></pre><p>In this case, the observation frame is assumed to be static, thus allowing to consider multiple observation times self-consistently, with light rays starting from the same position. For more details on this setup, see the <a href="#Image-plane">Image plane</a> section. However, when using Skylight.jl, we advise to always use the pinhole camera as it gives more accurate results and the computational cost is not much higher than for the image plane.</p><h2 id="Types"><a class="docs-heading-anchor" href="#Types">Types</a><a id="Types-1"></a><a class="docs-heading-anchor-permalink" href="#Types" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Skylight.PinholeCamera" href="#Skylight.PinholeCamera"><code>Skylight.PinholeCamera</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">PinholeCamera &lt;: AbstractCamera</code></pre><p>A type representing a pinhole camera for ray-tracing simulations. This type allows for arbitrary positions and velocities of the observation point, providing a more general approach compared to the image plane.</p><p><strong>Fields</strong></p><ul><li><code>position::Vector{Float64}</code>: The position of the camera in spacetime.</li><li><code>horizontal_aperture_in_degrees::Float64</code>: The horizontal aperture of the camera in degrees.</li><li><code>vertical_aperture_in_degrees::Float64</code>: The vertical aperture of the camera in degrees.</li><li><code>horizontal_number_of_pixels::Int</code>: The number of pixels along the horizontal aperture.</li><li><code>vertical_number_of_pixels::Int</code>: The number of pixels along the vertical aperture.</li><li><code>four_velocity::Vector{Float64}</code>: The four-velocity of the observation frame, defaulting to the static frame once the initial data is created.</li></ul><p><strong>Constructor</strong></p><pre><code class="language-julia hljs">camera = PinholeCamera(position = [0.0, distance, π / 2 - π / 20, 0.0],
    horizontal_aperture_in_degrees = rad2deg(315 / distance),
    vertical_aperture_in_degrees = rad2deg(315 / distance),
    horizontal_number_of_pixels = 600,
    vertical_number_of_pixels = 600)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/c1ebdeee792aa32e6ca99bb9a0867a9a82dac2e1/src/configurations/types.jl#L50-L73">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Skylight.ImagePlane" href="#Skylight.ImagePlane"><code>Skylight.ImagePlane</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ImagePlane &lt;: AbstractCamera</code></pre><p>A type representing an image plane camera for ray-tracing simulations. This type assumes that light rays arrive parallel from a distant source.</p><p><strong>Fields</strong></p><ul><li><code>distance::Float64</code>: The distance of the observation point from the origin.</li><li><code>observer_inclination_in_degrees::Float64</code>: The inclination of the observer with respect to the z-axis in degrees.</li><li><code>horizontal_side::Float64</code>: The horizontal side length of the image plane.</li><li><code>vertical_side::Float64</code>: The vertical side length of the image plane.</li><li><code>horizontal_number_of_pixels::Int</code>: The number of pixels along the horizontal side of the image plane.</li><li><code>vertical_number_of_pixels::Int</code>: The number of pixels along the vertical side of the image plane.</li><li><code>observation_times::Vector{Float64}</code>: The observation times, defaulting to <code>[0.0]</code>.</li></ul><p><strong>Constructor</strong></p><pre><code class="language-julia hljs">camera = ImagePlane(distance = 500.0,
    observer_inclination_in_degrees = 90,
    horizontal_side = 23.0,
    vertical_side = 23.0,
    horizontal_number_of_pixels = 100,
    vertical_number_of_pixels = 100)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joaquinpelle/Skylight.jl/blob/c1ebdeee792aa32e6ca99bb9a0867a9a82dac2e1/src/configurations/types.jl#L7-L32">source</a></section></article><h2 id="Details-of-the-construction"><a class="docs-heading-anchor" href="#Details-of-the-construction">Details of the construction</a><a id="Details-of-the-construction-1"></a><a class="docs-heading-anchor-permalink" href="#Details-of-the-construction" title="Permalink"></a></h2><h3 id="Pinhole-camera"><a class="docs-heading-anchor" href="#Pinhole-camera">Pinhole camera</a><a id="Pinhole-camera-1"></a><a class="docs-heading-anchor-permalink" href="#Pinhole-camera" title="Permalink"></a></h3><p>The energy-momentum tensor of the radiation field reads</p><p class="math-container">\[T^{ab} = \int k^a k^b \left( \frac{I_\nu}{\nu^3} \right) dK,\]</p><p>where <span>$dK = \nu d\nu d\Omega$</span> is the invariant volume element in the light-like momentum space. This can also be written as</p><p class="math-container">\[T^{ab} = \int_{S^2} \int_0^\infty n^a n^b I_\nu d\nu d\Omega,\]</p><p>where <span>$n^a = k^a / \nu$</span>. The radiative flux measured in the direction of <span>$\bar{n}^a$</span> in a reference frame with four-velocity <span>$u^a$</span> is defined as <span>$T^{ab} u_a \bar{n}_b$</span>.</p><p>To discretize this integral at position <span>$x^\mu$</span>, we take an orthonormal tetrad given by</p><p class="math-container">\[e_0 = \partial_t, \quad e_1 = -\partial_r, \quad e_2 = \partial_\phi, \quad e_3 = -\partial_\theta,\]</p><p>where <span>$(r, \theta, \phi)$</span> are some topologically spherical coordinates in spacetime. Here we are assuming the spacetime coordinates can be transformed to a topologically spherical system consisting of a temporal coordinate <span>$t$</span> and three spatial coordinates. This might seem restrictive in theory, but it is generic in practice. After calculating the set of vectos above, we orthonormalize it with respect to <span>$g_{\alpha \beta}(x^\mu)$</span>, the metric at that position. In flat spacetime with usual spherical coordinates, the interpretation of the resulting tetrad is simple: <span>$e_1$</span> points towards the origin, <span>$e_2$</span> is azimuthal, and <span>$e_3$</span> is polar. The construction is somewhat arbitrary, but in the end the choice of tetrad is not important; it is merely an artifact for parameterizing the flux integral and defining an integration domain as small as possible. This construction is general enough to allow arbitrary position and four-velocity in any spacetime, but it is particularly convenient for large distances in asymptotically flat spacetimes where the source can be covered by a small spherical sector centered in the radial direction.</p><p>To calculate the flux integral, we take angular coordinates <span>$(\alpha, \beta)$</span> in <span>$S^2$</span> such that the components in the tetrad of a vector can be written as</p><p class="math-container">\[k^0 = \nu\,, \quad k^1 = \nu \cos \alpha \cos \beta\,, \quad k^2 = \nu \sin \alpha \cos \beta\,, \quad k^3 = \nu \sin \beta\,.\]</p><p>The coordinates vary over <span>$-\pi \le \alpha &lt; \pi$</span> and <span>$-\pi/2 \le \beta \le \pi/2$</span>. In particular, <span>$(\alpha, \beta) = (0,0)$</span> maps to the direction of <span>$e_1$</span>. Additionally, in these coordinates, <span>$d\Omega = \cos \beta d\alpha d\beta$</span>. In practice, for the angular integration, we do not need to cover the entire celestial sphere from the observation point, but rather take ranges of <span>$(\alpha, \beta)$</span> that cover the image of the emitting source.</p><p>We then take a uniform angular grid given by</p><p class="math-container">\[\alpha_i = -\frac{s_\alpha}{2} + \left(i - \frac{1}{2}\right) \Delta \alpha, \quad \beta_j = -\frac{s_\beta}{2} + \left(j - \frac{1}{2}\right) \Delta \beta, \\
\Delta \alpha = \frac{s_\alpha}{N_\alpha}, \quad \Delta \beta = \frac{s_\beta}{N_\beta}, \quad 1 \le i \le N_\alpha, \quad 1 \le j \le N_\beta,\]</p><p>where <span>$s_\alpha, s_\beta$</span> are the horizontal and vertical angular apertures, respectively, and <span>$N_\alpha, N_\beta$</span> are the numbers of points per side of the grid. We take a partition into spherical sectors <span>$D_{ij} = [\alpha_i - \Delta \alpha/2, \alpha_i + \Delta \alpha/2] \times [\beta_j - \Delta \beta / 2, \beta_j + \Delta \beta /2]$</span> centered at <span>$(\alpha_i, \beta_j)$</span>, whose solid angle is</p><p class="math-container">\[\Delta \Omega_{ij} = \int_{D_{ij}} \cos \beta d\alpha d\beta = 2 \cos(\beta_j) \sin \left(\frac{\Delta \beta}{2} \right) \Delta \alpha,\]</p><p>Finally, we numerically approximate the flux integral as</p><p class="math-container">\[\sum_{ijk} I_{ijk} n^a_{ij} n^b_{ij} \Delta \Omega_{ij} \Delta \nu,\]</p><p>where <span>$I_{ijk} = I_{\nu_k}(n^a_{ij})$</span> and the components of the vectors <span>$n^a_{ij}$</span> in the tetrad are</p><p class="math-container">\[(1, \cos \alpha_i \cos \beta_j, \sin \alpha_i \cos \beta_j, \sin \beta_j),\]</p><p>which are transformed to the coordinate frame before contraction with <span>$u_a$</span> and <span>$\bar{n}_a$</span>.</p><h3 id="Image-plane"><a class="docs-heading-anchor" href="#Image-plane">Image plane</a><a id="Image-plane-1"></a><a class="docs-heading-anchor-permalink" href="#Image-plane" title="Permalink"></a></h3><p>For distant observation points in asymptotically flat spacetimes, it is reasonable to approximate that the light rays from the source arrive essentially parallel. This is the approach that many ray-tracing applications adopt, including in the <a href="https://academic.oup.com/mnras/article-abstract/515/1/1316/6631564?login=false">original Skylight paper</a>. Although this approximation is generally sufficient for most practical applications, it is not necessarily less computationally demanding than the more accurate pinhole camera approach.</p><p>Consider a Cartesian coordinate system <span>$(t,x,y,z)$</span> such that the observation point is located on the <span>$x$</span>-<span>$z$</span> plane at a distance <span>$D$</span> from the origin, and the inclination with respect to the <span>$z$</span>-axis is <span>$\xi$</span>. In the static frame, <span>$u^a = (\partial_t)^a$</span>, we have <span>$u^a n_a = 1$</span>, where <span>$n^a$</span> is the unit vector in the propagation direction of a photon. Since the observation point is distant, the image of the emitting source occupies some small spherical sector. If we take <span>$\bar{n}^a$</span> pointing to the center of such sector, then <span>$\bar{n}^a n_a \approx 1$</span> within the source&#39;s image. Given that the rays are approximately parallel, we can approximate the flux as</p><p class="math-container">\[F_\nu = \frac{1}{D^2} \int_{\mathcal{S}} I_\nu da db \,,\]</p><p>where <span>$\mathcal{S}$</span> is the image plane and <span>$(a,b)$</span> are rectangular coordinates on <span>$\mathcal{S}$</span>. These coordinates are related to the Cartesian coordinates through</p><p class="math-container">\[x = -b \cos \xi + D \sin \xi\,, \quad y = a\,, \quad z = b \sin \xi + D \cos \xi \,.\]</p><p>To calculate this integral, we approximate it numerically as a Riemann sum from a rectangular grid on the image plane, similarly to the method described in the <a href="#Pinhole-camera">Pinhole camera</a> section. Each grid point is taken as the initial position of a geodesic, with the initial spatial momentum normal to the image plane, and the temporal component of the momentum set such that the resulting four-vector is null. The specific intensity for each ray is also calculated in the same manner as described previously.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../radiativemodels/">« Radiative models</a><a class="docs-footer-nextpage" href="../configurations/configurations/">Configurations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Friday 12 July 2024 19:09">Friday 12 July 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
